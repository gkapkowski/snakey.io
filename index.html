<!DOCTYPE html>
<html>
<head>
    <title>Snakes</title>
    <style type="text/css">
      canvas { border: 1px solid black; }
    </style>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/lodash/4.17.4/lodash.min.js"></script>
</head>
<body>
    <canvas id="board" width="600" height="600"></canvas>
    <script type="text/javascript">
        var canvas = document.getElementById('board');
        var ctx = canvas.getContext('2d');

        const boardSize = 10;
        var board = [];

        const scale = 300/boardSize;

        let snakes = [
          [[2, 2], [2, 1]], // each snake is an array of snake elements' coordinates
          [[3, 3], [3, 2]]
        ];
        let apples = [[4, 4], [0, 0], [1, 3]];

        generateBoard(snakes, apples);
        (function loop(){
          setTimeout(function() {
            generateBoard(snakes, apples);
            loop();
          }, 2000);
        })();

        function generateBoard(snakes, apples) {
          board.length = 0;

          // create empty board
            for (var i = 0; i < boardSize; i++) {
              let row = new Array(boardSize);
              row.fill('.');
              board.push(row);
            }
          console.log(board);

          // fill board with apples
          for (var i = 0; i < apples.length; i++) {
            let [x, y] = apples[i];
            board[y][x] = 'o';
          }

          // draw snake
          for (var j = 0; j < snakes.length; j++) {
            let snake = snakes[j];
            for (var i = 0; i < snake.length; i++) {
              let [x, y] = snake[i];
              board[y][x] = i === 0 ? 'H' : '#';
            }
          }
          console.log('2', board);

          return board;
        }

        function draw() {

          console.log('drawing', board);
          for (let y = 0; y < board.length; y++) {
              let row = board[y];
              for (let x = 0; x < row.length; x++) {
                  let field = row[x];
                  console.log(field);
                  switch (field) {
                      case ".":
                          ctx.fillStyle = 'rgb(255, 255, 255)';
                          ctx.fillRect(x * scale, y * scale, scale, scale);
                          break;
                      case "#":
                          ctx.fillStyle = 'rgb(120, 120, 120)';
                          ctx.fillRect(x * scale, y * scale, scale, scale);
                          break;
                      case "H":
                          ctx.fillStyle = 'rgb(0, 0, 0)';
                          ctx.fillRect(x * scale, y * scale, scale, scale);
                          break;
                      case "o":
                          ctx.fillStyle = 'rgb(200, 0, 0)';
                          ctx.beginPath();
                          ctx.arc(x * scale + parseInt(scale/2), y * scale + parseInt(scale/2), scale/2, 0, Math.PI*2);
                          ctx.fill();
                          break;
                  }

              }
          }
          window.requestAnimationFrame(draw);
        }

        function snake1() {
          let directions = ['right', 'left', 'up', 'down'];
          let direction = _.sample(directions);

          return direction;
        }

        window.requestAnimationFrame(draw);

    </script>
</body>
</html>
